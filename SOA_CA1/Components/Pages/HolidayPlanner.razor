@page "/holiday"
@rendermode InteractiveServer
@using Microsoft.AspNetCore.Components.Forms
@inject SOA_CA1.Services.Holidays.IHolidayService Holidays

<h3>Holiday Planner</h3>

<div class="mb-3">
    <label class="form-label">Date:</label>
    <InputDate @bind-Value="date" class="form-control" />
</div>

<div class="mb-3">
    <label class="form-label">Country (IE, ES, PL):</label>
    <InputText @bind-Value="country" class="form-control" />
</div>

<button class="btn btn-primary" @onclick="Check">Check</button>

@if (checking)
{
    <p class="mt-3">Checking…</p>
}
else
{

    <p class="mt-3">@status</p>
}

@code {
    DateOnly date = DateOnly.FromDateTime(DateTime.Today);
    string country = "IE";

    bool checking;
    string status = "Not checked yet";

    async Task Check()
    {
        checking = true; status = "Checking…";
        try
        {
            var isHoliday = await Holidays.IsPublicHolidayAsync(date, country.ToUpperInvariant());
            status = isHoliday ? "Public holiday" : "Not a public holiday";
        }
        catch (Exception ex) { status = $"Error: {ex.Message}"; }
        finally { checking = false; }
    }
}
